pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--test
--by david gmeindl
--note: each character in string
--is 4 pixels wide 
--(with space to next one)

c_txt={}
 
function c_txt:new(str,x_,y_,col_)
 local o={}
 setmetatable(o, self)
 self.__index = self
 o.w=4
 o.h=4
 o.x=x_
 o.y=y_
 o.x_init=0
 o.y_init=0
 o.dx=2
 o.dy=0
 o.col=col_
 o.str=str
 o.out_xbound=false
 o.out_ybound=false
 return o
end

function _init()
 debug=false	
 phy_vel=0
 phy_acc=0.05
 phy_maxvel=5
 phy_minvel=-5

 -- setting up txt_array
 txt_array={}
 txt_init_offset=75
 for i=0,15 do
  local t=c_txt:new("test",
          -txt_init_offset + i * 4,
          i*6,
          i)
  t.y_init=t.y
  t.x_init=t.x
 	add(txt_array,t)
 end
 
 txt_v=c_txt:new("vel: ",84,123,8)
end

function _update60()
 --set global vel -> moving right
 phy_vel+=phy_acc
 	
	-- slow donw or accellerate vel
	if phy_vel > phy_maxvel or 
	   phy_vel < phy_minvel then
		phy_acc=-phy_acc
	end	
		
	-- move texts
	for o in all(txt_array) do
		local len=4 * #o.str
		check_xbound(o,phy_vel,len)
		o.x+=phy_vel
	end
	debug_1(txt_array[1])
	
	if all_out_xbound(txt_array) then
		for o in all(txt_array) do
		 --if out to the left,
		 --continue on the right side
		 if phy_vel<0 and o.x<0 then
				o.x=o.x_init+127+txt_init_offset
				--change color
    o.col=rnd(16)
			--if out to the right
			--continue on the left side
			elseif phy_vel>0 and o.x>127 then
			 o.x=o.x_init
			 --change color
    o.col=rnd(16)
			end
		end
	end
	--]]
end

function _draw()
 cls(7)

	--print velocity
	local strv=txt_v.str..tostr(phy_vel)
	--print(strv,txt_v.x,txt_v.y,
	--      txt_v.col)
		
	--print text array
 for x in all(txt_array) do
 	print(x.str,x.x,x.y,x.col)
 end
 
end
-->8
function check_xbound(o,vel,tlen)
 if o.x>127 or o.x<0 then
 	o.out_xbound=true
 	--sfx(0)
 else
  o.out_xbound=false
 end
end

function all_out_xbound(a)
	all_=true
	for x in all(a) do
	 if not x.out_xbound then 
	 	all_=false
	 end
	end
	return all_
end

function debug_1(o)
 if (not debug) then return end
 local str=tostr(o.x).."\t"
 str=str.."init: "..tostr(o.x_init).."\t"
 str=str.."v: "..tostr(phy_vel).."\t"
 str=str..tostr(o.out_xbound)
 str=str.."\t"..tostr(all_out_xbound(txt_array))
 printh(str)
end
__label__
77777777777777777777777777777777777777777777788878887788788877777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777778778777877778777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777778778877888778777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777778778777778778777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777778778887887778777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777711171117711711177777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777771771777177771777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777771771177111771777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777771771777771771777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777771771117117771777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777722272227722722277777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777772772777277772777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777772772277222772777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777772772777772772777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777772772227227772777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777733373337733733377777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777773773777377773777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777773773377333773777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777773773777773773777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777773773337337773777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777744474447744744477777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777774774777477774777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777774774477444774777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777774774777774774777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777774774447447774777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777775557555775575557777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777577577757777577777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777577557755577577777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777577577777577577777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777577555755777577777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777776667666776676667777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777677677767777677777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777677667766677677777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777677677777677677777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777677666766777677777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777888788877887888777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777787787778777787777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777787788778887787777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777787787777787787777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777787788878877787777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777799979997799799977777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777779779777977779777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777779779977999779777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777779779777779779777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777779779997997779777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777aaa7aaa77aa7aaa7777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777a77a777a7777a77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777a77aa77aaa77a77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777a77a77777a77a77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777a77aaa7aa777a77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777bbb7bbb77bb7bbb7777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777b77b777b7777b77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777b77bb77bbb77b77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777b77b77777b77b77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777b77bbb7bb777b77777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777ccc7ccc77cc7ccc77777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777c77c777c7777c777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777c77cc77ccc77c777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777c77c77777c77c777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777c77ccc7cc777c777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777ddd7ddd77dd7ddd77777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777d77d777d7777d777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777d77dd77ddd77d777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777d77d77777d77d777777777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777d77ddd7dd777d777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777eee7eee77ee7eee
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777e77e777e7777e7
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777e77ee77eee77e7
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777e77e77777e77e7
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777e77eee7ee777e7
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777fff7fff77ff
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777f77f777f77
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777f77ff77fff
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777f77f77777f
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777f77fff7ff7
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777787878887877777777777777788777777888788878887
77777777777777777777777777777777777777777777777777777777777777777777777777777777777787878777877778777777777778777777778787878787
77777777777777777777777777777777777777777777777777777777777777777777777777777777777787878877877777777777888778777777778788878887
77777777777777777777777777777777777777777777777777777777777777777777777777777777777788878777877778777777777778777777778777877787
77777777777777777777777777777777777777777777777777777777777777777777777777777777777778778887888777777777777788877877778777877787

__sfx__
00010000161401714018140191501a1501a1501b1501c1501e1501f150221502315025150261502715024140211401d1401714001140083000430001300013000230002300023000230002300023000330003300
